<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Technical • CAMDAC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Technical">
<meta property="og:description" content="CAMDAC">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CAMDAC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/setup.html">Installation</a>
    </li>
    <li>
      <a href="../articles/pipeline.html">CAMDAC pipeline</a>
    </li>
    <li>
      <a href="../articles/output.html">Results</a>
    </li>
    <li>
      <a href="../articles/visualisation.html">Visualisation</a>
    </li>
    <li>
      <a href="../articles/questions.html">FAQs</a>
    </li>
    <li>
      <a href="../articles/technical.html">Technical</a>
    </li>
    <li>
      <a href="../articles/panels.html">DNA methylation panels</a>
    </li>
    <li>
      <a href="../articles/copy_number_alt.html">Alternative CNA calling</a>
    </li>
    <li>
      <a href="../articles/allele-specific.html">Allele-specific Methylation</a>
    </li>
    <li>
      <a href="../articles/deconvolution.html">CAMDAC Deconvolution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="technical_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Technical</h1>
            
      
      
      <div class="hidden name"><code>technical.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="technical-notes">Technical Notes<a class="anchor" aria-label="anchor" href="#technical-notes"></a>
</h2>
<p><br> In this section, we provide a high-level summary of the CAMDAC pipeline. There are six key steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Allele Counting</strong>: Obtain allele counts at SNP and CpG loci.<br>
</li>
<li>
<strong>Copy-number calling</strong>: Obtain allele-specific copy number profiles, tumour purity and SNP plot data.</li>
<li>
<strong>Methylation Processing</strong>: Filter, format and plot methylation data.</li>
<li>
<strong>Deconvolution</strong>: Deconvolve the pure tumour methylation rates from bulk tumour RRBS data.</li>
<li>
<strong>Differential methylation analysis</strong>: Perform differential tumour-normal methylation analysis.</li>
</ol>
<p>Take a hypothetical female patient with primary tumour sample ID “<strong>T1</strong>” and normal sample ID “<strong>N1</strong>”. First, CAMDAC takes the BAM files from each sample and counts SNP and CpG (methylation) alleles. The orientation-aware counter ensures that SNP and CpG sites are accurately measured.</p>
<p>B-allele frequencies at heterozygous SNPs are leveraged to calculate pure tumour copy number aberrations using either ASCAT.m for RRBS or Battenberg.m for WGBS.</p>
<p>ASCAT.m, our tool for allele-specific copy number profiling, is integrated within CAMDAC module 3, <strong>run_ASCAT.m</strong>. ASCAT.m requires patient-matched normal RRBS data. The patient-matched normal RRBS data should be processed <em>before</em> the tumour samples from the same patient setting <strong>sample_id</strong>=<strong>patient_matched_normal_id</strong>. If a patient-matched normal is not available, you must set this variable to NULL (default = NULL) and provide the <strong>reference_panel_coverage</strong> variable (see details under <em>Step 3</em> below).</p>
<p>A normal proxy for the methylation rate of the tumour-infiltrating normal cells, <strong>normal_infiltrates_proxy_id</strong> (<span class="math inline">\(m_{n,i}\)</span>), is required for tumour-normal deconvolution. We also need a best guess substitute for the tumour cell of origin, <strong>normal_origin_proxy_id</strong> (<span class="math inline">\(m_{n,o}\)</span>), which will be used tumour-normal differential methylation analysis. In this hypothetical example, we set both the normal infiltrates and the normal cell of origin to a patient-matched adjacent normal sample with <strong>sample_id</strong>=“N1”.</p>
<p>CAMDAC outputs will be stored at the user-defined project <strong>path</strong> variable. A patient folder is created at this path with directory name set to <strong>patient_id</strong>. This will contain 3 subdirectories: Allelecounts, Copy_Number and Methylation. Within these 3 results folders, a directory is created for each of a given patient’s samples. In this example, a folder for each ‘N1’ and ‘T1’ would be generated. Users should also provide a character string pointing to the CAMDAC installation path in the <strong>path_to_CAMDAC</strong> variable.</p>
<p>Finally, users should provide the full path and file name for the RRBS binary mapping alignments (.bam) file for this sample, indicating whether it is aligned to either hg19, hg38, GRCH37 or GRCH38. Bases should be quality and adapter trimmed and PCR duplicates should be removed. Please ensure that the bam file is sorted and indexed.</p>
<div class="section level5">
<h5 id="step-1-obtain-allele-counts-at-snp-and-cpg-loci">Step 1: Obtain allele counts at SNP and CpG loci<a class="anchor" aria-label="anchor" href="#step-1-obtain-allele-counts-at-snp-and-cpg-loci"></a>
</h5>
<p>The first step is to obtain dinucleotide read counts are CpGs and single nucleotide counts at 1000 genome SNP positions[^2]. CpG loci created by SNP positions are also included. If you are unsure of the reference genome build of your BAM file, but know it is either ‘hg19’, ‘hg38’, ‘GRCH37’ or ‘GRHCH38’, input <strong>build=NULL</strong> and let CAMDAC determine the build version for you.</p>
<p>To speed up the computation, we built a reference RRBS genome listing all genomic regions supported by $$5 reads in $$1 of in a panel of normal lung tissue with NuGEN <em>MspI</em> digested RRBS[^3],[^4] data. This step greatly reduces the number of loci to investigate since RRBS data only covers about 2% of the human genome. Reference loci files are divided into 25 smaller files to reduce memory requirements. The ‘<strong>get_allele_counts</strong>’ function is run within a loop whereby the i<sup>th</sup> iteration of the function pulls the corresponding i<sup>th</sup> reference file. We recommend running this function as a simple for loop as it is internally parrallelised by <strong>n_cores</strong>.</p>
<p>Note that read mapping quality threshold is set to <strong>mq</strong>=0. This is important so as not to create bias against the alternate allele for reads with polymorphisms. RRBS alignments are validated based on read start sites as opposed to mapping quality. This flag will become relevant in future CAMDAC versions compatible with WGBS data.</p>
</div>
<div class="section level5">
<h5 id="step-1-obtain-allele-counts-at-snp-and-cpg-loci-1">Step 1: Obtain allele counts at SNP and CpG loci<a class="anchor" aria-label="anchor" href="#step-1-obtain-allele-counts-at-snp-and-cpg-loci-1"></a>
</h5>
<p>The first step is to obtain dinucleotide read counts are CpGs and single nucleotide counts at 1000 genome SNP positions[^2]. CpG loci created by SNP positions are also included. If you are unsure of the reference genome build of your BAM file, but know it is either ‘hg19’, ‘hg38’, ‘GRCH37’ or ‘GRHCH38’, input <strong>build=NULL</strong> and let CAMDAC determine the build version for you.</p>
<p>To speed up the computation, we built a reference RRBS genome listing all genomic regions supported by $$5 reads in $$1 of in a panel of normal lung tissue with NuGEN <em>MspI</em> digested RRBS[^3],[^4] data. This step greatly reduces the number of loci to investigate since RRBS data only covers about 2% of the human genome. Reference loci files are divided into 25 smaller files to reduce memory requirements. The ‘<strong>get_allele_counts</strong>’ function is run within a loop whereby the i<sup>th</sup> iteration of the function pulls the corresponding i<sup>th</sup> reference file. We recommend running this function as a simple for loop as it is internally parrallelised by <strong>n_cores</strong>.</p>
<p>Note that read mapping quality threshold is set to <strong>mq</strong>=0. This is important so as not to create bias against the alternate allele for reads with polymorphisms. RRBS alignments are validated based on read start sites as opposed to mapping quality. This flag will become relevant in future CAMDAC versions compatible with WGBS data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compile (di)nucleotide counts at SNPs and at CpGs for bisulfite sequencing data</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">a</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="../reference/get_allele_counts.html">get_allele_counts</a></span><span class="op">(</span>i<span class="op">=</span><span class="va">a</span>, patient_id<span class="op">=</span><span class="va">patient_id</span>, sample_id<span class="op">=</span><span class="va">sample_id</span>, sex<span class="op">=</span><span class="va">sex</span>, bam_file<span class="op">=</span><span class="va">bam_file</span>,</span>
<span>                  mq<span class="op">=</span><span class="fl">0</span>, path<span class="op">=</span><span class="va">path</span>, path_to_CAMDAC<span class="op">=</span><span class="va">path_to_CAMDAC</span>, build<span class="op">=</span><span class="va">build</span>, n_cores<span class="op">=</span><span class="va">n_cores</span>,       </span>
<span>                  test<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Set to TRUE for a test run with data downsampling</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function creates a subdirectory <strong>path</strong>/<strong>patient_id</strong>/Allelecounts/<strong>sample_id</strong> in the directory where the output .fst files are stored with file name <strong>patient_id</strong>.<strong>sample_id</strong>.<strong>i</strong>.SNPs.CpGs.fst.</p>
<p>Each of the 25 files will be concatenated in the next module and contains:</p>
<ul>
<li>single nucleotide counts at SNPs</li>
<li>dinucleotide counts at CpGs</li>
<li>polymorphism-indepedent methylation rates at CpGs</li>
<li>BAF and coverage at SNPs <br><br>
</li>
</ul>
</div>
<div class="section level5">
<h5 id="step-2-concatenate-allele-counts-outputs-and-plot-mspi-fragment-size-distribution">Step 2: Concatenate allele counts outputs and plot <em>MspI</em> fragment size distribution<a class="anchor" aria-label="anchor" href="#step-2-concatenate-allele-counts-outputs-and-plot-mspi-fragment-size-distribution"></a>
</h5>
<p>We now combine the output files from the previous module into a single document. One new variable is introduced here, <strong>is_normal</strong>, a logical set to TRUE if the <strong>sample_id</strong> is that of a normal sample, to be used downstream as proxy for the bulk tumour normal infiltrates and/or the cell of origin.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Is the sample being processed normal or tumour?</span></span>
<span><span class="va">normal_ids</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">patient_matched_normal_id</span>, <span class="va">normal_infiltrates_proxy_id</span>, <span class="va">normal_origin_proxy_id</span><span class="op">)</span></span>
<span><span class="va">is_normal</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sample_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">normal_ids</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Format output nucleotide counts</span></span>
<span><span class="fu"><a href="../reference/format_output.html">format_output</a></span><span class="op">(</span>patient_id<span class="op">=</span><span class="va">patient_id</span>, sample_id<span class="op">=</span><span class="va">sample_id</span>, sex<span class="op">=</span><span class="va">sex</span>, is_normal<span class="op">=</span><span class="va">is_normal</span>, </span>
<span>              path<span class="op">=</span><span class="va">path</span>, path_to_CAMDAC<span class="op">=</span><span class="va">path_to_CAMDAC</span>, build<span class="op">=</span><span class="va">build</span><span class="op">)</span></span></code></pre></div>
<p>If the function is successful, the 25 sub-files are removed leaving only one .RData file remains with all of the compiled SNP and methylation information. This file is named <strong>patient_id</strong>.<strong>sample_id</strong>.<strong>i</strong>.SNPs.CpGs.RData can be read by simply loading the .RData object and contains the following columns:</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_formatted_allele_counts_output.png" alt=""><p class="caption"><strong>Figure 3.</strong> Formatted SNP and methylation information</p>
</div>
</center>
<p><br> Each row is either a CCGG or CG locus and/or a 1000g SNP position. These can be distinguished by the <em>width</em> column. While polymorphic CG/CCGG have the same width as their non-polymorphic counterpart, they are easily identified by looking at the <em>POS</em>, <em>ref</em>, <em>alt</em> and other SNP-informative columns.</p>
<p>For each SNP locus, 1000g genomic coordinate and reference and alternate alleles are listed under <em>POS</em>, <em>ref</em> and <em>alt</em> columns. The <em>total_counts</em> is the sum of <em>alt_counts</em> and <em>ref_counts</em>, which including all informative strand-specific allele counts. For example, at <span class="math inline">\(C&gt;T\)</span> SNPs, only the reverse strand allows to distinguish between the (un)methylated reference and the alternate allele and thus all forward read counts would be excluded from the <em>total_counts</em> column, but included in the <em>total_depth</em>. The SNP <em>type</em> column is only added to the patient-matched normal, which is used to assign SNP genotypes as either Homozygous (BAF$&lt;<span class="math inline">\(0.15 | BAF\)</span>&gt;$0.85) or Hetorozygous (0.15 <span class="math inline">\(\leq\)</span> BAF <span class="math inline">\(\leq\)</span> 0.85).</p>
<p><em>M</em>, <em>UM</em>, <em>total_counts_m</em>, and <em>m</em> are respectively the counts methylated and unmethylated, the total counts (un)methylated and the methylation rate. Methylation rates are calculated per CG allele, meaning that at polymorphic CpGs, only the CG-forming allele counts are considered. CAMDAC methylation rates are therefore polymorphism-independent.</p>
<p>For CCGG loci, the <em>CCGG</em> column indicates the number of fragments with a 5’ end at this CCGG loci. This number may be 0 at polymorphic CCGG loci homozygous for the CCGG-destroying allele.</p>
<p><em>MspI</em> fragment boundaries are determined from the aligned reads and <em>MspI</em> fragment the size distribution is obtained as QC (see <strong>path</strong>/<strong>patient_id</strong>/Copy_number/<strong>sample_id</strong>/fragment_length_histogram.pdf). You should observe 3 disctinct peaks in the fragment length distribution. This is characteristic of human RRBS libraries and originates from <em>MspI</em> containing micro-satellite repeats of distinct lengths. The <em>MspI</em> fragment boundaries and their GC content are saved as an .RData object at <strong>path</strong>/<strong>patient_id</strong>/Copy_number/<strong>sample_id</strong>/msp1_fragments_RRBS.RData for use in copy number profiling.</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_fragment_length_histogram.png" style="width:50.0%" alt=""><p class="caption"><strong>Figure 4.</strong> <em>MspI</em> fragment size distribution</p>
</div>
</center>
<p><br></p>
</div>
<div class="section level5">
<h5 id="step-3-purity-estimation-allele-specific-copy-number-profiling-snp-data-qc">Step 3: Purity estimation, allele-specific copy number profiling, SNP data QC<a class="anchor" aria-label="anchor" href="#step-3-purity-estimation-allele-specific-copy-number-profiling-snp-data-qc"></a>
</h5>
<p>Next, we run ASCAT.m, our module for allele-specific copy number profiling of tumours directly from RRBS data. ASCAT.m is inspired from ASCAT principles <a href="https://doi.org/10.1073/pnas.1009843107" class="external-link">Van Loo <em>et al.</em>, 2010</a>[^5].</p>
<p>A few new variables are introduced at this stage, namely <strong>patient_matched_normal_id</strong>, a character variable set to the <strong>sample_id</strong> of the patient-matched normal. If a patient-matched normal is not available, you must set this variable to NULL (default = NULL) and provide <strong>reference_panel_coverage</strong>. The latter should contain the full path to a .fst file with sex-matched normal RRBS data. We have generated normal RRBS coverage reference panel for male and female samples for hg19/GRCH37 which you may use.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get copy number (includes LogR bias correction)</span></span>
<span><span class="fu"><a href="../reference/run_ASCAT.m.html">run_ASCAT.m</a></span><span class="op">(</span>patient_id<span class="op">=</span><span class="va">patient_id</span>, sample_id<span class="op">=</span><span class="va">sample_id</span>, sex<span class="op">=</span><span class="va">sex</span>,  </span>
<span>            patient_matched_normal_id<span class="op">=</span><span class="va">patient_matched_normal_id</span>, </span>
<span>            path<span class="op">=</span><span class="va">path</span>, path_to_CAMDAC<span class="op">=</span><span class="va">path_to_CAMDAC</span>, build<span class="op">=</span><span class="va">build</span>,</span>
<span>            min_normal<span class="op">=</span><span class="fl">10</span>, <span class="co"># minimum read count at SNPs in normal samples</span></span>
<span>            min_tumour<span class="op">=</span><span class="fl">1</span>, <span class="co"># minimum read count at SNPs in tumour samples</span></span>
<span>            n_cores<span class="op">=</span><span class="va">n_cores</span>, </span>
<span>            reference_panel_coverage<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> </span>
<span>            <span class="co"># For hg19 aligned reads, you may use the example file at:</span></span>
<span>            <span class="co"># file.path(path_to_CAMDAC,"pipeline_files","example_data", </span></span>
<span>            <span class="co">#           paste0("normal_lung_cov_",sex,".fst"))</span></span></code></pre></div>
<p><br> If the function is successful, you should find a file named <strong>patient_id</strong>.<strong>sample_id</strong>.SNPs.RData in the CAMDAC copy number output directory (<strong>path</strong>/<strong>patient_id</strong>/Copy_number/<strong>sample_id</strong>/). For the patient-matched normal, the output is as pictured below:</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_SNP_output.png" style="width:70.0%" alt=""><p class="caption"><strong>Figure 5.</strong> Normal SNP data.table</p>
</div>
</center>
<p><br></p>
<p>Each row is a 1000g SNP position with minimum coverage defined by <strong>min_normal</strong> (default = 10). The <em>total_counts</em> column is the total informative read counts. For example, at C<span class="math inline">\(&gt;\)</span>T SNPs, only the reverse strand allows to distinguish between the unmethylated reference and the alternate allele and thus, forward read counts would not contribute to the <em>total_counts</em> and the <em>BAF</em> (B-allele frequency calculation). <em>rBAF</em> is randomly assigned <em>BAF</em> or 1-<em>BAF</em> to remove biases against the alternate allele in downstream tumour copy number profiling. All read counts however contribute to the <em>total_depth</em> which is used for LogR calculation, a measure of total coverage. Genotyping is performed and assignments stored under <em>type</em>.</p>
<p>In addition to the SNP information .RData object, a pdf file named <strong>patient_id</strong>_<strong>sample_id</strong>_normal_SNP_data.pdf is output, an example of which is displayed below (<strong>Figure 6</strong>). These plots enable users to evaluate the magnitude of biases against alternate of (B)-alleles (<strong>Figure 6A</strong>). The number of homozygous to heterozygous SNPs is depicted and any biases in coverage against the latter can be evaluated (<strong>Figure 6B</strong>). Due to being biases for CpG-rich genomic regions, a typical RRBS sample should show a high ratio of C<span class="math inline">\(&gt;\)</span>T SNPs. We note that C<span class="math inline">\(&gt;\)</span>T and A<span class="math inline">\(&gt;\)</span>G germline heterozygous SNPs will have roughly half the coverage of the 4 types of SNPs (<strong>Figure 6C</strong>).</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_normal_SNP_data.png" style="width:65.0%" alt=""><p class="caption"><strong>Figure 6.</strong> Normal SNP data QC</p>
</div>
</center>
<p><br></p>
<p>After patient-matched normal sample processing, runASCAT.m is performed on tumour samples. As before, when running this step on tumour samples, the .RData output is the first generated. The suffix ’_n’ is added to columns relating to the patient-matched normal.</p>
<p>In addition to the above-mentionned columns, we also have the tumour LogR pre- and post-correction, <em>LogR_t</em> and <em>LogR_t_corr</em>, respectively. The LogR is a normalised measure of tumour coverage used by ASCAT(.m) for copy number profiling together with the BAF, which each of the covariates used for LogR correction are displayed:</p>
<ul>
<li>
<em>msp1_length</em>: The <em>MspI</em> fragment length is highly variable and we observe sequencing biases against fragments at the extremes of the fragment size distribution.</li>
<li>
<em>GC_content</em>: The <em>MspI</em> GC content leads to sequencing biases, namely at the PCR amplification step.</li>
<li>
<em>replic</em>: The local genomic replication timing affects the number of copies present at a given locus in cells undergoing S phase.</li>
</ul>
<p>Next, the standard ASCAT output are then generated. All files have the dot-separated patient and sample IDs as prefix, ‘<strong>patient_id</strong>.<strong>sample_id</strong>’. The file suffix is the name of the enclosed R object.</p>
<p>Briefly, we plot the BAF and LogR and save the ASCAT(.m) input ‘ascat.bc’ object. In the BAF profiles, heterozygous SNPs are highlighted in red. Note that ASCAT LogR correction steps are skipped as RRBS-specific correction is completed in previous steps. The BAF and LogR tracks are then segmented yielding the allele-specific piece-wise constant fitting (ASPCF) plot and ‘ascat.frag’ object.</p>
<p>If a tumour purity and ploidy solution is succesfully obtained via a grid search (see sunrise plot), it is stored in the ‘ascat.output’ object. Raw and rounded allele-specific copy number segments are plotted as the rawprofile.png and ASCATprofile.png images, respectively.</p>
<p>Finally, the purity, ploidy, number of heterozygous and homozygous 1000g SNP positions and median tumour and normal SNP depth is saved in a .txt file. This is so that this information can easily be collated across sample in large cohorts.</p>
<p>The summary SNP data is plotted and saved as a pdf with filename <strong>patient_id</strong>_<strong>sample_id</strong>_SNP_data.pdf and may help you troubleshoot your data. A median SNP coverage above 60 (<em>total_depth</em>) is recommended as it represents on average 30 informative strand-specific read counts at both C<span class="math inline">\(&gt;\)</span>T and A<span class="math inline">\(&gt;\)</span>G SNPs (<em>total_counts</em>). On average roughly 1 in 20 1000g SNPs covered by RRBS is heterozygous and of those, roughly 1 in 2 are in either CG or CCGG context.</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_SNP_data.png" style="width:90.0%" alt=""><p class="caption"><strong>Figure 7.</strong> Tumour SNP data summary</p>
</div>
</center>
<p><br></p>
</div>
<div class="section level5">
<h5 id="step-4-filter-format-and-plot-methylation-data">Step 4: Filter, format and plot methylation data<a class="anchor" aria-label="anchor" href="#step-4-filter-format-and-plot-methylation-data"></a>
</h5>
<p>The normal and bulk tumour methylation rates are processed next. A normal proxy is required for both the normal infiltrates and normal cell of origin. If you are using the same sample for both, you may set <strong>normal_infiltrates_proxy_id</strong> and <strong>normal_origin_proxy_id</strong> variables to the same character string. You should run CAMDAC modules 1-4 on your normal sample(s) before your tumour samples. When running on your normal sample(s), sample_id with be the same as either <strong>normal_infiltrates_proxy_id</strong> and/or <strong>normal_origin_proxy_id</strong>. The normal infiltrates proxy should ideally be patient-matched normal data. If this is unavailable, it is possible to submit a suitable tissue- and sex-matched reference profile. Ideally, this profile consists of the median reads counts across several normal samples.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Process bulk tumour and normal methylation data</span></span>
<span><span class="fu"><a href="../reference/run_methylation_data_processing.html">run_methylation_data_processing</a></span><span class="op">(</span></span>
<span>      patient_id<span class="op">=</span><span class="va">patient_id</span>, sample_id<span class="op">=</span><span class="va">sample_id</span>,</span>
<span>      normal_infiltrates_proxy_id<span class="op">=</span><span class="va">normal_infiltrates_proxy_id</span>, </span>
<span>      normal_origin_proxy_id<span class="op">=</span><span class="va">normal_origin_proxy_id</span>, path<span class="op">=</span><span class="va">path</span>, </span>
<span>      min_normal<span class="op">=</span><span class="fl">10</span>, <span class="co"># Minimum read count for the CG-allele in normal samples</span></span>
<span>      min_tumour<span class="op">=</span><span class="fl">3</span>, <span class="co"># Minimum read count for the CG-allele in tumour samples</span></span>
<span>      n_cores<span class="op">=</span><span class="va">n_cores</span><span class="op">)</span></span></code></pre></div>
<p><br> If the function is successful, you should find a file named dt_normal_m.RData in the CAMDAC methylation output directory (<strong>path</strong>/<strong>patient_id</strong>/Methylation/<strong>sample_id</strong>/). Note that the file name correspond to the name of the R object it contains.</p>
<p>For the patient- and tissue-matched normal sample “N1”, the methylation data columns have the suffix is <span class="math inline">\(x = n\)</span>, since <span class="math inline">\(m_{n,i} \sim m_{n,o}\)</span>. Where <span class="math inline">\(m_{n,i} \neq m_{n,o}\)</span>, the suffix is set to <span class="math inline">\(x = n\_i\)</span> for the normal infiltrates and <span class="math inline">\(x = n\_o\)</span> for the normal cell of origin proxy sample. The uncertainty on <span class="math inline">\(m_{x}\)</span> is computed as the lower and upper boundaries of the 99% Highest Density Interval (HDI) are stored under columns <span class="math inline">\(m_{x,low}\)</span> and <span class="math inline">\(m_{x,high}\)</span>.</p>
<ul>
<li>
<em>CHR</em>: Chromosome name with ‘chr’ prefix</li>
<li>
<em>start</em>: First base of CG/CCGG</li>
<li>
<em>end</em>: Last base of CG/CCGG</li>
<li>
<em>M_x</em>: Counts methylated</li>
<li>
<em>UM_x</em>: Counts unmethylated</li>
<li>
<em>m_x</em>: Methylation rate</li>
<li>
<em>m_x_low</em>: Lower boundary of the 99% HDI for <span class="math inline">\(m_{x}\)</span>
</li>
<li>
<em>m_x_high</em>: Upper boundary of the 99% HDI for <span class="math inline">\(m_{x}\)</span>
</li>
</ul>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_normal_methylation_output.png" style="width:50.0%" alt=""><p class="caption"><strong>Figure 8.</strong> Normal methylation output.</p>
</div>
</center>
<p>In the normal sample methylation output directory, you will find a pdf with methylation data summary and QC. For normal tumour RRBS data, we expected to sit near 0 and 1 (<strong>Figure 9A,B</strong>). Non-polymorphic CpG/CCpGG make up the majority of the data (<strong>Figure 9C,D</strong>). Median CpG coverage above 40 are recommended.</p>
<p>Note that methylation rates are calculated in a polymorphism-independent manner, meaning that the CG-destroying allele at a heterozygous CpG does not contribute to its methylation rate. The minimum coverage threshold is therefore set to the CpG-allele read depth. Germline heterozygous SNPs included in copy number profiling may thus be removed here due to insufficient coverage.</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_normal_methylation_rate_summary.png" style="width:90.0%" alt=""><p class="caption"><strong>Figure 9.</strong> Normal methylation rate QC.</p>
</div>
</center>
<p><br></p>
<p>When running module 4 on tumour samples (e.g. <strong>sample_id</strong>=“T1”), the data.table created is saved as .RData object titled ‘dt_tumour_and_normal_m.RData’. As the name suggests, this temporary file contains the (bulk) tumour methylation rates as well as the normal(s). Columns pertaining to bulk tumour methylation information have the suffix ’_b’ appended.</p>
<p>The same methylation QC plots are produced for the bulk tumour. Increased intermediate methylation is expected (<strong>Figure 10</strong>). In non-small cell lung cancer, we attribute this to mostly clonal bi-alleleic differential methylation and show the m_b values at those loci is driven by tumour purity and copy number <a href="https://doi.org/10.1101/2020.11.03.366252" class="external-link">Larose Cadieux et <em>al.</em>, 2020</a><sup>1</sup>.</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_tumour_methylation_rate_summary_panelA.png" style="width:40.0%" alt=""><p class="caption"><strong>Figure 10.</strong> Normal methylation rate QC.</p>
</div>
</center>
<p><br></p>
</div>
<div class="section level5">
<h5 id="step-5-deconvolve-the-pure-tumour-methylation-rates-from-bulk-tumour-rrbs-data">Step 5: Deconvolve the pure tumour methylation rates from bulk tumour RRBS data<a class="anchor" aria-label="anchor" href="#step-5-deconvolve-the-pure-tumour-methylation-rates-from-bulk-tumour-rrbs-data"></a>
</h5>
<p>Running steps 1-4 on the normal(s) and subsequently on the bulk tumour RRBS data, we obtained methylation rates for both the normal infiltrates, bulk tumour as well as tumour copy number and purity estimates. We have all the necessary information to obtain CAMDAC pure tumour methylation rates, <span class="math inline">\(m_t\)</span> (<strong>Figure 1</strong>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get pure tumour methylation rates </span></span>
<span><span class="fu"><a href="../reference/get_pure_tumour_methylation.html">get_pure_tumour_methylation</a></span><span class="op">(</span></span>
<span>      patient_id<span class="op">=</span><span class="va">patient_id</span>, sample_id<span class="op">=</span><span class="va">sample_id</span>, sex<span class="op">=</span><span class="va">sex</span>,  </span>
<span>      normal_infiltrates_proxy_id<span class="op">=</span><span class="va">normal_infiltrates_proxy_id</span>,  </span>
<span>      path<span class="op">=</span><span class="va">path</span>, path_to_CAMDAC<span class="op">=</span><span class="va">path_to_CAMDAC</span>, build<span class="op">=</span><span class="va">build</span>, n_cores<span class="op">=</span><span class="va">n_cores</span>,  </span>
<span>      reseg<span class="op">=</span><span class="cn">FALSE</span> <span class="co"># Multi-sample re-segmentation of the copy number profiles </span></span>
<span>                   <span class="co"># will be available in future versions of CAMDAC.</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>This function generates a file named ‘dt_purified_tumour.RData’ and removes the now redundant ‘dt_tumour_and_normal_m.RData’ in the CAMDAC methylation output directory (<strong>path</strong>/<strong>patient_id</strong>/Methylation/<strong>sample_id</strong>/).</p>
<p>In addition to columns reported in ‘dt_tumour_and_normal_m’, CpG copy number and purified tumour methylation data are added.</p>
<ul>
<li>
<em>nA</em>: Major allele copy number</li>
<li>
<em>nB</em>: Minor allele copy number</li>
<li>
<em>CN</em>: Total allele copy number</li>
<li>
<em>seg_start</em>: Copy number segment start point</li>
<li>
<em>seg_end</em>: Copy number segment end point</li>
<li>
<em>CG_CN</em>: CpG allele total copy number (this differ from <em>CN</em> at polymorphic CpGs)</li>
<li>
<em>m_t_raw</em>: Raw CAMDAC purified tumour methylation rate</li>
<li>
<em>m_t_corr</em>: Corrected CAMDAC purified tumour methylation rate</li>
<li>
<em>cov_t</em>: CAMDAC purified tumour effective read coverage</li>
<li>
<em>m_t_low</em>: CAMDAC purified tumour 99% HDI lower boundary</li>
<li>
<em>m_t_high</em>: CAMDAC purified tumour 99% HDI upper boundary</li>
</ul>
<p>For compatibility with other software, we also save CAMDAC pure tumour methylation rates in a BED3+1 format with:</p>
<ul>
<li>
<em>chrom</em>: Chromsome name (i.e. 1, 2, …, X)</li>
<li>
<em>start</em>: First base of CG/CCGG</li>
<li>
<em>end</em>: Last base of CG/CCGG</li>
<li>
<em>score</em>: Corrected CAMDAC purified tumour methylation rate</li>
</ul>
<p>With purified tumour methylation rates in hand, one can accurately examine distances between normal and tumour methylomes, or between tumour methylomes themselves. CAMDAC computes the Pearson correlations and plots the relationships between tumour and normal as 2D density heatmaps, saving them as a pdf named ‘tumour_versus_normal_methylomes.pdf’.</p>
<p>CAMDAC deconvoluted methylation rate can have any values between 0 and 1 while the range of bulk tumour methylation rates is driven by tumour DNA content. (<strong>Figure 1,11</strong>). In the bulk tumour profiles, bi-allelic tumour-normal differentially methylated positions appear at intermediate methylation values while after purification, they form a peak near 0 or 1 for hypo- and hypermethylated positions, respectively<a href="https://doi.org/10.1101/2020.11.03.366252" class="external-link">Larose Cadieux et <em>al.</em>, 2020</a><sup>1</sup>. <br><br></p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_tumour_versus_normal_methylomes.png" style="width:60.0%" alt=""><p class="caption"><strong>Figure 11.</strong> Tumour <em>versus</em> normal methylation rates from before and after CAMDAC.</p>
</div>
</center>
<p><br></p>
</div>
<div class="section level5">
<h5 id="step-6-perform-differential-tumour-normal-methylation-analysis">Step 6: Perform differential tumour-normal methylation analysis<a class="anchor" aria-label="anchor" href="#step-6-perform-differential-tumour-normal-methylation-analysis"></a>
</h5>
<p>Leveraging CAMDAC purified methylomes, we then obtain differentially methylated positions and regions.</p>
<p>We introduce a few new variables. The <strong>effect_size</strong> flag is the minimum tumour-normal methylation rate difference and <strong>prob</strong> the probability threshold, representing the probability that the tumour and normal beta distributions do not overlap. Both variables are used for calling differentially methylated positions (DMPs).</p>
<p>To identify differentially methylated regions (DMRs), we group CpGs into bins and look for clusters with at least 5 DMPs (<strong>min_DMP_counts_in_DMR</strong>=5), 4 of which must be consecutive (<strong>min_consec_DMP_in_DMR</strong>=4).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Carry out differential methylation analysis</span></span>
<span><span class="fu"><a href="../reference/get_differential_methylation.html">get_differential_methylation</a></span><span class="op">(</span></span>
<span>      patient_id<span class="op">=</span><span class="va">patient_id</span>, sample_id<span class="op">=</span><span class="va">sample_id</span>, sex<span class="op">=</span><span class="va">sex</span>,  </span>
<span>      normal_origin_proxy_id<span class="op">=</span><span class="va">normal_origin_proxy_id</span>,</span>
<span>      path<span class="op">=</span><span class="va">path</span>, path_to_CAMDAC<span class="op">=</span><span class="va">path_to_CAMDAC</span>, build<span class="op">=</span><span class="va">build</span>,</span>
<span>      effect_size<span class="op">=</span><span class="fl">0.2</span>, <span class="co"># Minimum effect-size to call a differentially methylated loci</span></span>
<span>      prob<span class="op">=</span><span class="fl">0.99</span>, <span class="co"># Probability threshold to call a differentially methylated loci</span></span>
<span>      min_DMP_counts_in_DMR<span class="op">=</span><span class="fl">5</span>, <span class="co"># Minimum number of DMPs to call a DMR</span></span>
<span>      min_consec_DMP_in_DMR<span class="op">=</span><span class="fl">4</span>, <span class="co"># Minimum number of consecutive DMPs to call a DMR</span></span>
<span>      n_cores<span class="op">=</span><span class="va">n_cores</span><span class="op">)</span></span></code></pre></div>
<p>After completion, this function generates a file name ‘CAMDAC_results_per_CpG.RData’ in the CAMDAC methylation output directory (<strong>path</strong>/<strong>patient_id</strong>/Methylation/<strong>sample_id</strong>/). This R object is a combination of all CAMDAC results per CpG and differs ‘dt_purified_tumour’ in that DMP information is added to the columns previously described.</p>
<ul>
<li>
<em>m_diff_tn</em>: CAMDAC-purified tumour <span class="math inline">\(-\)</span> normal methylation rates</li>
<li>
<em>prob_DMP</em>: DMP probability</li>
<li>
<em>DMP_t</em>: DMP calls based on CAMDAC-purified tumour <em>versus</em> normal methylation rates</li>
</ul>
<p>DMP summary statistics are compile in a text file named <strong>patient_id</strong>_<strong>sample_id</strong>_DMP_stats.txt. This is so that this information can easily be collated across sample in large cohorts. For compatibility with other software, we also save CAMDAC pure tumour-normal DMPs in a BED5+1 format with one extra named <em>effect_size</em> column as shown below:</p>
<ul>
<li>
<em>chrom</em>: Chromsome name (i.e. 1, 2, …, X)</li>
<li>
<em>start</em>: First base of CG/CCGG</li>
<li>
<em>end</em>: Last base of CG/CCGG</li>
<li>
<em>name</em>: “hyper” or “hypo”</li>
<li>
<em>score</em>: DMP probability based on CAMDAC-purified tumour methylation rates</li>
<li>
<em>effect_size</em>: CAMDAC-purified tumour <span class="math inline">\(-\)</span> normal methylation rates</li>
</ul>
<p>Next, CAMDAC builds on DMP calls to call DMRs. Due to RRBS sparsity, CpGs are readily grouped into clusters to from bins which are annotated using BioMart to pull features from either Ensembl GRCH37 or 38.</p>
<p>DMR summary statistics across various Ensembl genomic annotations are compile in a text file named <strong>patient_id</strong>_<strong>sample_id</strong>_DMR_stats.txt. We provide CAMDAC pure tumour-normal DMRs in a BED5+1 format. Here, <em>name</em> can take 3 values, “hyper”, “hypo” or “mixed”. The <em>score</em> column becomes the average DMP probability across DMP hotspots within DMRs and the <em>effect_size</em> is the mean difference between CAMDAC-purified and normal methylation rates across these loci. Alternatively, a large data.table with annotated DMRs is available as an .RData objet. All numerical values represent the mean of a given varaible across tumour-normal DMPs within a given CpG cluster. Columns include:</p>
<ul>
<li>
<em>cluster_id</em>: RRBS CpG cluster</li>
<li>
<em>chrom</em>: Chromsome name (i.e. 1, 2, …, X)</li>
<li>
<em>start</em>: First base of CG/CCGG</li>
<li>
<em>end</em>: Last base of CG/CCGG</li>
<li>
<em>m_n</em>: normal methylation rate</li>
<li>
<em>m_n_low</em>: normal methylation rate HDI99 lower boundary</li>
<li>
<em>m_n_high</em>: normal methylation rate HDI99 upper boundary</li>
<li>
<em>m_t</em>: CAMDAC pure tumour methylation rate</li>
<li>
<em>m_t_low</em>: CAMDAC pure tumour methylation rate HDI99 lower boundary</li>
<li>
<em>m_t_high</em>: CAMDAC pure tumour methylation rate HDI99 upper boundary</li>
<li>
<em>prob</em>: Tumour-noraml DMP probability</li>
<li>
<em>CG_CN</em>: CpG allele total copy number</li>
<li>
<em>nA</em>: Major allele copy number</li>
<li>
<em>nB</em>: Minor allele copy number</li>
<li>
<em>segment</em>: Copy number segment endpoints</li>
<li>
<em>DMR_type</em>: “hyper”, “hypo” or “mixed”</li>
<li>
<em>CpG_counts</em>: Number of CpGs in a given bin</li>
<li>
<em>DMP_counts</em>: Number of DMPs</li>
<li>
<em>consec_DMPs</em>: Number of consecutive DMPs</li>
<li>
<em>DMR</em>: “DMR” if differentially methylated, NA otherwise.</li>
</ul>
<p>In addition, several annotations are provided. Regions that overlap with genes are labelled as “intragenic” under the column of the same name and “intergenic” otherwise. Associated gene(s) symbol(s) and Ensembl ID(s) are provided under <em>gene_ids</em>. Exon, intron, 5<span class="math inline">\(^\prime\)</span> (F-) and 3<span class="math inline">\(^\prime\)</span> (T-) untranslated regions (UTR) gene body annotations can be found under their namesake column, <em>exon</em>, <em>intron</em>, <em>FUTR</em> and <em>TUTR</em>.</p>
<p>The <em>CGI</em> column distinguishes between CpG Islands (“CGI”), shores (“shore”) and shelves (“shelf”) and open sea (“NA”). Enhancers are flagged up as “enhancer” under the <em>enhancer</em> column, which is otherwise “NA”. The associated genenhancer ids can be found under <em>enhancer_ids</em>. Importantly, promoters are denoted under <em>promoter</em> and the related gene(s) are labelled below <em>gene_prom_ids</em>.</p>
<p>Finally, repetitive elements are listed as “repeat” under <em>repeats</em> with more details available in the adjacent columns <em>repeat_name</em>, <em>repeat_class</em> and <em>repeat_family</em>.</p>
<p>The ratio of hyper- to hypomethylated DMRs varies across genomic regions (<strong>Figure 12</strong>, top panel). This is reflected by the tumour-normal methylation rate difference (<strong>Figure 12</strong>, bottom panel).</p>
<center>
<div class="figure">
<img src="images/CAMDAC_manual_DMR_summary_plots.png" style="width:80.0%" alt=""><p class="caption"><strong>Figure 12.</strong> DMR summary data.</p>
</div>
</center>
<p><br></p>
</div>
<div class="section level4">
<h4 id="leveraging-camdac-outputs">Leveraging CAMDAC outputs<a class="anchor" aria-label="anchor" href="#leveraging-camdac-outputs"></a>
</h4>
<p>With CAMDAC differential methylation calls in hand, users may choose to look for recurrently aberrated loci across their cohort. Note that tumour-tumour DMPs can be easily identified by looking for overlap between the 99% HDIs for CAMDAC pure tumour methylation rates between samples (99% HDI <span class="math inline">\(\subseteq\)</span> [<strong>m_t_low</strong>,<strong>m_t_high</strong>]).</p>
<p><em>Clustering</em> analyses can also easily be performed by the user using well-established R packages such as ‘pvclust’ for hierarchical clustering with bootstrap and ‘umap’ (uniform manifold approximation and projection) for non-linear dimensionality reduction. Clustering of pure tumour methylation rates at promoter DMRs across large cohorts by ‘umap’ may reveal histology and/or sex-driven clusters as described in non-small cell lung cancer <a href="https://doi.org/10.1101/2020.11.03.366252" class="external-link">Larose Cadieux et <em>al.</em>, 2020</a><sup>1</sup>.</p>
<p>For multi-region RRBS data, sample tree reconstruction by neighbour joining leveraging CAMDAC pure tumour methylation rates at hypermethylated DMPs in at least on sample, subset to loci confidently unmethylated in the normal cell of origin (<strong>m_n_high</strong>&lt;0.2), can reveal inter-sample relationships, as demonstrated in non-small cell lung cancer <a href="https://doi.org/10.1101/2020.11.03.366252" class="external-link">Larose Cadieux et <em>al.</em>, 2020</a><sup>1</sup>.</p>
<p>When running gene-set enrichment analysis (<em>GSEA</em>) on CAMDAC DMR calls, gene sets should be limited to those genes with promoters covered by RRBS. It may be desirable to subset DMR calls to hypermethylated promoter-associated CpG Islands given that methylation at these loci is most correlated with expression.</p>
<p>Users may leverage normal, deconvoluted tumour methylation rates and tumour-normal DMP calls to separate clonal mono- and bi-allelic from subclonal bi-allelic methylation changes to shed light into tumour evolutionary histories <a href="https://doi.org/10.1101/2020.11.03.366252" class="external-link">Larose Cadieux et <em>al.</em>, 2020</a><sup>1</sup>. The allele-specific CAMDAC module will be made available in future releases.</p>
</div>
<div class="section level4">
<h4 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h4>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Elizabeth Larose Cadieux, Nana Mensah, Carla Castignani, Jonas Demeulemeester, Peter Van Loo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
